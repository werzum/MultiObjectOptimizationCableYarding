### Documentation for src Folder

---

#### **Overview**

The src folder contains the core modules and scripts for the Multi-Object Optimization Cable Yarding project. These modules are responsible for performing geometric computations, mechanical calculations, optimization routines, and cable road computations. The folder is structured to ensure modularity, reusability, and scalability of the codebase.

---

### **Module Descriptions**

#### **1. `global_vars.py`**

- **Purpose**:
  - Manages global variables and shared resources across the project.
  - Initializes and stores shared data structures like KD-Trees for spatial queries.
- **Key Functions**:
  - `init(height_gdf)`: Initializes global variables, such as KD-Trees, using the provided height GeoDataFrame.
  - `get_kdtree()`: Returns the initialized KD-Tree for spatial queries.
- **Relation**:
  - Used by multiple modules (e.g., cable_road_computation_main.py, `mechanical_computations.py`) to access shared spatial data efficiently.

---

#### **2. `geometry_utilities.py`**

- **Purpose**:
  - Provides utility functions for geometric computations, such as calculating angles and distances.
- **Key Functions**:
  - `angle_between(line1, line2)`: Computes the angle between two 2D lines.
  - `angle_between_3d_lines(line1, line2)`: Computes the angle between two 3D lines.
  - `distance_between_points(point1, point2)`: Calculates the Euclidean distance between two points.
- **Relation**:
  - Extensively used in cable_road_computation_main.py and `mechanical_computations.py` for geometric validations and calculations.

---

#### **3. `mechanical_computations.py`**

- **Purpose**:
  - Handles mechanical calculations related to cable roads, such as tension, forces, and angles.
- **Key Functions**:
  - `compute_angle_between_supports(line, height_gdf)`: Computes the angle between the supports of a cable road.
  - `calculate_tension(force, angle)`: Calculates the tension in a cable based on the applied force and angle.
  - `get_line_3d_from_cr_startpoint_to_centroid(cable_road_object, ...)`: Computes a 3D line from the start point of a cable road to its centroid.
- **Relation**:
  - Used in cable_road_computation_main.py to validate and compute mechanical properties of cable roads.

---

#### **4. `cable_road_computation.py`**

- **Purpose**:
  - Contains the core logic for computing cable road configurations, including support trees and anchor points.
- **Key Functions**:
  - `generate_tree_anchor_support_trees(overall_trees, target, point, line)`: Identifies support trees for a given cable road line.
  - `generate_triple_angle(start_point, line, anchor_trees)`: Computes valid anchor triples based on geometric constraints.
  - `compute_required_supports(...)`: Determines the required supports for a cable road based on tension and height constraints.
- **Relation**:
  - Called by cable_road_computation_main.py to generate and validate cable road configurations.

---

#### **5. cable_road_computation_main.py**

- **Purpose**:
  - The main module for generating and validating cable road configurations.
  - Integrates geometric, mechanical, and optimization computations to produce valid cable road candidates.
- **Key Functions**:
  - `generate_possible_lines(...)`: Generates and validates possible cable road lines based on geometric and mechanical constraints.
- **Relation**:
  - Acts as the central module, orchestrating computations from `geometry_utilities.py`, `mechanical_computations.py`, and `cable_road_computation.py`.

---

#### **6. optimization_execution.py**

- **Purpose**:
  - Implements optimization routines for cable road configurations.
  - Supports single-objective and multi-objective optimization.
- **Key Functions**:
  - `soo_optimization_augmecon(...)`: Performs single-objective optimization using the Augmented Îµ-Constraint method.
  - `soo_optimization_manual_weights(...)`: Executes single-objective optimization with manually assigned weights.
- **Relation**:
  - Used to optimize cable road configurations generated by cable_road_computation_main.py.

---

#### **7. `classes_geometry_objects.py`**

- **Purpose**:
  - Defines custom geometric objects (e.g., 3D points and lines) for advanced computations.
- **Key Classes**:
  - `Point_3D`: Represents a 3D point with x, y, and z coordinates.
  - `LineString_3D`: Represents a 3D line segment between two `Point_3D` objects.
- **Relation**:
  - Used in `geometry_utilities.py` and `mechanical_computations.py` for 3D geometric operations.

---

#### **8. `classes_cable_road_computation.py`**

- **Purpose**:
  - Defines classes for representing and managing cable road configurations.
- **Key Classes**:
  - `forest_area`: Represents a forest area with attributes like tree GeoDataFrames and height data.
  - `cable_road`: Represents a cable road configuration, including its supports, anchors, and mechanical properties.
- **Relation**:
  - Used in cable_road_computation_main.py to manage and validate cable road configurations.

---

#### **9. `interface.py`**

- **Purpose**:
  - Provides an interactive interface for visualizing and managing cable road computations.
  - Uses `ipywidgets` for creating interactive elements.
- **Key Functions**:
  - `interactive_cr_selection(...)`: Allows users to interactively select and visualize cable road configurations.
- **Relation**:
  - Acts as the user-facing module, integrating results from cable_road_computation_main.py and optimization_execution.py.

---

### **Inter-Module Relationships**

1. **Core Computation Flow**:

   - cable_road_computation_main.py is the central module that orchestrates computations.
   - It uses `geometry_utilities.py` for geometric validations, `mechanical_computations.py` for mechanical calculations, and `cable_road_computation.py` for generating and validating cable road configurations.

2. **Optimization**:

   - optimization_execution.py optimizes the configurations generated by cable_road_computation_main.py.

3. **Data Management**:

   - `global_vars.py` provides shared resources like KD-Trees for spatial queries.
   - `classes_geometry_objects.py` and `classes_cable_road_computation.py` define the data structures used across the project.

4. **User Interaction**:
   - `interface.py` provides an interactive interface for visualizing and managing cable road computations.

---

### **How to Use**

1. **Initialize Global Variables**:

   - Use `global_vars.init(height_gdf)` to initialize shared resources.

2. **Generate Cable Road Configurations**:

   - Call `generate_possible_lines(...)` from cable_road_computation_main.py to generate and validate cable road configurations.

3. **Optimize Configurations**:

   - Use `soo_optimization_augmecon(...)` or `soo_optimization_manual_weights(...)` from optimization_execution.py to optimize the generated configurations.

4. **Visualize Results**:
   - Use `interactive_cr_selection(...)` from `interface.py` to interactively visualize and manage the results.

---

This documentation provides a comprehensive overview of the src folder, its modules, and their relationships, ensuring clarity and ease of use for developers.
